#!/bin/bash
root="${XRK_ROOT:-/xrk}"
[ -f "$root/shell_modules/menu_common.sh" ] && source "$root/shell_modules/menu_common.sh"
menu_init 0 1  # 初始化：不需要common，需要check_changes（检测xyz路径，.init会加载init.sh）

# 显示帮助信息
show_help() {
  echo "用法: xyz [参数]"
  echo "选项:"
  echo "  无参数    - 正常启动葵崽"
  echo "  数字参数  - 启动葵崽并传递该数字参数"
  echo "  --h, -h   - 显示此帮助信息"
  exit 0
}

# 处理帮助参数
if [[ "$1" == "--h" || "$1" == "-h" ]]; then
  show_help
fi
echo "正在启动葵崽"
redis-server --daemonize yes --save 900 1 --save 300 10

# 根据是否有参数决定执行方式
if [ -z "$1" ]; then
  # 无参数时，按原来方式执行
  cd $xyz && node --expose-gc app
else
  # 有参数时，将参数传递给node app
  cd $xyz && node --expose-gc app "$1"
fi